<?xml version="1.0" encoding="utf-8"?>
<chapter label="1" revision="$Id$"
         version="5" xmlns="http://docbook.org/ns/docbook"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:ns5="http://www.w3.org/1999/xhtml"
         xmlns:ns4="http://www.w3.org/2000/svg"
         xmlns:ns3="http://www.w3.org/1998/Math/MathML"
         xmlns:ns="http://docbook.org/ns/docbook">
  <title>Introduction</title>

  <para>When the OSGi Alliance started in 1998 the focus was in residential
  gateways, it actually was an acronym that contained the word
  <emphasis>gateway</emphasis> before it became a name. Since that time, OSGi
  flourished in several different markets but did not gain a wide-spread
  adoption in the residential markets so far. However, some of the road blocks
  to this wide spread adoption have changed:</para>

  <itemizedlist>
    <listitem>
      <para>Hardware cost of service gateways have been reduced.</para>
    </listitem>

    <listitem>
      <para>Capabilities of those small devices increased many fold.</para>
    </listitem>

    <listitem>
      <para>The license fee for Java Virtual Machines has decreased.</para>
    </listitem>

    <listitem>
      <para>The number of devices in a house hold has increased.</para>
    </listitem>

    <listitem>
      <para>Always-on and broadband access to the Internet has become
      pervasive.</para>
    </listitem>
  </itemizedlist>

  <para>This specification, produced by the OSGi Residential Expert Group
  (REG), defines a set of new and refined service guidelines that focus on the
  residential market. The REG is chartered to define the requirements and
  specifications to tailor the OSGi Framework for fixed network connected
  devices. Examples of such devices include residential gateways, building
  automation controllers, white goods, consumer electronics, and many other
  devices.</para>

  <para>Technical Areas addressed by the REG include the requirements,
  functional specifications, and APIs for gateway devices. The REG also
  created a functional model for local and remote management of gateway
  devices. This model resolves the requirements of inter-operation with
  existing management systems and protocols, the need to remotely manage the
  user applications life cycles, the need for large-scale deployments and
  adequate security.</para>

  <para>The services of this Residential Specification have been designed with
  the residential market in mind. Requirements and management protocols for
  this environment are defined in the specifications by consortias like the
  <xref linkend="i434636"/>, (HGI) the <xref linkend="i434640"/> (BBF) and the
  <xref linkend="i434644"/>. These specifications provide requirements for
  execution environments in a Consumer Premises Equipment (CPE) and other
  consumer devices, as well as protocols for the management of residential
  environments. Here, the scope of management protocols span the remote
  management of thousands and millions of CPE devices by a telecommunications
  provider as well as local management of single consumer devices in a home or
  residence building.</para>

  <para>The services guidelines of the Residential Specification have been
  designed to integrate with OSGi, fulfill the requirements of the mentioned
  consortias and cooperate with each other. None of the listed service
  specifications is mandatory; all service specifications are optional.</para>

  <para>It is not suggested, or expected, that a solution will support all
  listed specifications. More likely, platform providers define their specific
  runtime environment. It is highly recommended to choose the mandatory and
  optional services defined by the <xref linkend="i435333"/> as a basis. The
  same is true for the management protocols defined by BBF and the UPnP Forum.
  A solution can further include other core and compendium services that are
  not listed as part the Residential Specification.</para>

  <section>
    <title>Overview of the Residential Specifications</title>

    <section>
      <title>Remote Management</title>

      <para>Support for remotely managing the service and their applications
      is essential to all systems that are installed on customer’s premises.
      The specification therefore has special focus on large scale remote
      management of the OSGi Framework. The architecture provides a solution
      to allow management over different protocols although the primary focus
      is to allow the use Broadband Forum’s suite of specifications on an OSGi
      residential gateway. This section introduces the related
      specifications.</para>

      <itemizedlist>
        <listitem>
          <para><emphasis>Dmt Admin Service Specification – </emphasis>The Dmt
          Admin Service Specification provides an API for a remote manager to
          manage the device and its diverse services running on it. The Dmt
          Admin provides a generic tree structure, the Device Management Tree
          (DMT), to a Protocol Adapter. The nodes of those trees are
          implemented by the devices and services. Different Protocol Adapters
          can leverage the same DMT for different protocols. The Dmt Admin
          service also provides guidelines for object models that can be made
          available over different protocols. For more details see the <xref
          linkend="service.dmt"/>.</para>
        </listitem>

        <listitem>
          <para><emphasis>Residential Device Management</emphasis> – This
          specification defines a Residential Management Tree, the RMT. This
          tree provides a general Dmt Admin object model that allows browsing
          and managing the OSGi Framework remotely over different Protocol
          Adapters. The RMT provides access to the Framework and the Log
          service. It also provides a filter function on top of Dmt Admin. See
          the <xref linkend="dmtree.residential"/> for details.</para>
        </listitem>

        <listitem>
          <para><emphasis>TR-157a3 Software Module</emphasis> – <xref
          linkend="i434640"/> has defined a generic model for mapping software
          modules in <xref linkend="i437933"/>. This specification provides a
          recommended mapping for the generic concepts to the OSGi Framework
          concepts. See <xref linkend="tr157softwaremodules"/>.</para>
        </listitem>

        <listitem>
          <para><emphasis>TR-069 Connector Service Specification</emphasis> –
          The Dmt Admin service and the TR-069 protocol have different
          semantics and primitives. This specification contains the <xref
          linkend="service.tr069todmt"/>. This specification provides an API
          based on the TR-069 Remote Procedure Calls concept that is
          implemented on top of Dmt Admin. This connector supports data
          conversion and the object modeling constructs defined in the Dmt
          Admin service, <xref
          linkend="service.dmt.osgiobjectmodeling"/>.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section>
      <title>Management and Configuration services</title>

      <para>The OSGi Framework is unique in that it does not hide anything,
      all aspects are manageable from the system itself. To locally manage the
      system, the following services are available:</para>

      <itemizedlist>
        <listitem>
          <para><emphasis>Conditional Permission Admin Service
          Specification</emphasis> – The Conditional Permission Admin service
          allows an operator to control the Java Permissions to be granted to
          the bundles running on the OSGi Framework using a condition based
          model. See chapter 50 in <xref linkend="i432874"/>.</para>
        </listitem>

        <listitem>
          <para><emphasis>Permission Admin Service Specification</emphasis> –
          The Permission Admin service allows an operator to control the Java
          Permissions to be granted to the bundles running on the OSGi
          Framework based on the bundle location. The Permission Admin has
          been superseded by the Conditional Permission admin, but is included
          for backwards compatibility. See chapter 51 in <xref
          linkend="i432874"/>.</para>
        </listitem>

        <listitem>
          <para><emphasis>URL Handlers Service Specification</emphasis> – This
          specification standardizes the mechanism to extend the Java run-time
          with new URL schemes and content handlers. Dynamically extending the
          URL schemes that are supported in an OSGi Framework is a very
          powerful concept to provide more functionality to existing
          applications. See chapter 51 in <xref linkend="i432874"/>.</para>
        </listitem>

        <listitem>
          <para><emphasis>User Admin Service Specification</emphasis> – The
          User Admin Service Specification provides authorization for OSGi
          Framework actions based on authenticated users instead of using the
          Java code-based permission model. See the <xref
          linkend="service.useradmin"/>.</para>
        </listitem>

        <listitem>
          <para><emphasis>Initial Provisioning Specification</emphasis> – The
          Initial Provisioning specification defines how a Management Agent
          and other initial bundles can be deployed on an uninitialized OSGi
          Framework. It gives a structured view of the problems and their
          corresponding resolution methods. The purpose of this specification
          is to enable the management of a Framework by an operator, and
          (optionally) to hand over the management of the Framework later to
          another operator. See the <xref linkend="service.provisioning"/> for
          more details.</para>
        </listitem>

        <listitem>
          <para><emphasis>Configuration Admin Service Specification</emphasis>
          – The Configuration Admin service allows an operator or an
          application bundle developer to set the configuration information of
          bundles. See <xref linkend="service.cm"/>.</para>
        </listitem>

        <listitem>
          <para><emphasis>Metatype Service Specification</emphasis> – The
          Metatype specification defines interfaces that allow bundle
          developers to describe attribute types in a computer readable form
          using metadata. It is mostly used in conjunction with the
          Configuration Admin Service. See <xref linkend="service.metatype"/>
          for details.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section>
      <title>Component Models</title>

      <para>Component models allow the code in bundles to remain unaware of
      OSGi API by using Dependency Injection (DI) while still providing full
      support for the OSGi service model.</para>

      <itemizedlist>
        <listitem>
          <para><emphasis>Declarative Services Specification</emphasis> – The
          Declarative Services specification provides dependency injection for
          services. It handles the service life cycle dynamics by notifying
          the component or managing the components life cycle. See <xref
          linkend="service.component"/>.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section>
      <title>HTTP and Servlets</title>

      <para>HTTP Server and Servlets functions are often needed for the
      residential gateway. The Specification contains this
      specification:</para>

      <itemizedlist>
        <listitem>
          <para><emphasis>Http Service Specification</emphasis> – Developers
          typically need to develop communication and user interface solutions
          for standard technologies such as HTTP, HTML, XML, and servlets. See
          the <xref linkend="service.http"/>.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section>
      <title>Event models</title>

      <para>The OSGi service model is based on synchronous APIs. Support for
      asynchronous invocations and event driven interactions usually involves
      the definition of listeners. However, this model does not scale well for
      fine grained events that must be dispatched to many different handlers.
      The Specification therefore contains the Event Admin Service
      Specification:</para>

      <itemizedlist>
        <listitem>
          <para><emphasis>Event Admin Service Specification</emphasis> – The
          Event Admin service provides an inter-bundle communication
          mechanism. It is based on a event publish and subscribe model,
          popular in many message based systems. See <xref
          linkend="service.event"/>.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section>
      <title>Other Residential Services</title>

      <para>A residential gateway can directly attach devices, for example via
      a USB adaptor, through a home network. There is therefore a need to have
      a unified device abstraction, discovery and control model. For this
      purpose, this Specification contains the following services:</para>

      <itemizedlist>
        <listitem>
          <para><emphasis>Device Access Specification</emphasis> – The Device
          Access specification supports the coordination of automatic
          detection and attachment of existing devices on an OSGi Framework,
          facilitates hot-plugging and -unplugging of new devices, and
          downloads and installs device drivers on demand. See <xref
          linkend="service.device"/>.</para>
        </listitem>

        <listitem>
          <para><emphasis>UPnP™ Device Service Specification</emphasis> – The
          UPnP specification specifies how OSGi bundles can be developed that
          inter-operate with UPnP (Universal Plug and Play) devices and UPnP
          control points. The specification is based on <xref
          linkend="i437630"/>. See <xref linkend="service.upnp"/>.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section>
      <title>Miscellaneous Supporting Services</title>

      <para>Services providing solutions to common infrastructure requirements
      include:</para>

      <itemizedlist>
        <listitem>
          <para><emphasis>Log Service Specification</emphasis> – Provides a
          general purpose message logger for the OSGi Framework. See the <xref
          linkend="service.log"/>.</para>
        </listitem>

        <listitem>
          <para><emphasis>XML Parser Service Specification</emphasis> –
          Addresses how the classes defined in JAXP can be used in an OSGi
          Framework. See <xref linkend="util.xml"/>.</para>
        </listitem>
      </itemizedlist>
    </section>
  </section>

  <section>
    <title>Version Information</title>

    <para>This document is the Residential Specification for the OSGi
    Residential Release 5.</para>

    <section xml:id="intro.core.release">
      <title>OSGi Core Release 5</title>

      <para>This specification is based on the OSGi Core Release 5. This
      specification can be downloaded from:</para>

      <programlisting>http://www.osgi.org/Specifications/HomePage</programlisting>
    </section>

    <section>
      <title>Component Versions</title>

      <para>Components in this specification have their own specification
      version, independent of this specification. The following table
      summarizes the packages and specification versions for the different
      subjects.</para>

      <table>
        <title>Packages and versions</title>

        <tgroup cols="3">
          <colspec colnum="1" colwidth="3*"/>

          <colspec colnum="2" colwidth="2.5*"/>

          <colspec colnum="3" colwidth="0.8*"/>

          <thead>
            <row>
              <entry>Item</entry>

              <entry>Package(s)</entry>

              <entry>Version</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry><xref linkend="dmtree.residential"
              xrefstyle="template:%n %t"/></entry>

              <entry><code><xref
              linkend="org.osgi.dmt.residential"/></code><superscript>*</superscript></entry>

              <entry><code><xref endterm="org.osgi.dmt.residential-version"
              linkend="dmtree.residential"/></code></entry>
            </row>

            <row>
              <entry><xref linkend="service.log"
              xrefstyle="template:%n %t"/></entry>

              <entry><code><xref
              linkend="org.osgi.service.log"/></code></entry>

              <entry><code><xref endterm="org.osgi.service.log-version"
              linkend="service.log"/></code></entry>
            </row>

            <row>
              <entry><xref linkend="service.http"
              xrefstyle="template:%n %t"/></entry>

              <entry><code><xref
              linkend="org.osgi.service.http"/></code></entry>

              <entry><code><xref endterm="org.osgi.service.http-version"
              linkend="service.http"/></code></entry>
            </row>

            <row>
              <entry><xref linkend="service.device"
              xrefstyle="template:%n %t"/></entry>

              <entry><code><xref
              linkend="org.osgi.service.device"/></code></entry>

              <entry><code><xref endterm="org.osgi.service.device-version"
              linkend="service.device"/></code></entry>
            </row>

            <row>
              <entry><xref linkend="service.cm"
              xrefstyle="template:%n %t"/></entry>

              <entry><code><xref
              linkend="org.osgi.service.cm"/></code></entry>

              <entry><code><xref endterm="org.osgi.service.cm-version"
              linkend="service.cm"/></code></entry>
            </row>

            <row>
              <entry><xref linkend="service.metatype"
              xrefstyle="template:%n %t"/></entry>

              <entry><code><xref
              linkend="org.osgi.service.metatype"/></code></entry>

              <entry><code><xref endterm="org.osgi.service.metatype-version"
              linkend="service.metatype"/></code></entry>
            </row>

            <row>
              <entry><xref linkend="service.useradmin"
              xrefstyle="template:%n %t"/></entry>

              <entry><code><xref
              linkend="org.osgi.service.useradmin"/></code></entry>

              <entry><code><xref endterm="org.osgi.service.useradmin-version"
              linkend="service.useradmin"/></code></entry>
            </row>

            <row>
              <entry><xref linkend="service.provisioning"
              xrefstyle="template:%n %t"/></entry>

              <entry><code><xref
              linkend="org.osgi.service.provisioning"/></code></entry>

              <entry><code><xref
              endterm="org.osgi.service.provisioning-version"
              linkend="service.provisioning"/></code></entry>
            </row>

            <row>
              <entry><xref linkend="service.upnp"
              xrefstyle="template:%n %t"/></entry>

              <entry><code><xref
              linkend="org.osgi.service.upnp"/></code></entry>

              <entry><code><xref endterm="org.osgi.service.upnp-version"
              linkend="service.upnp"/></code></entry>
            </row>

            <row>
              <entry><xref linkend="service.component"
              xrefstyle="template:%n %t"/></entry>

              <entry><para><code><xref
              linkend="org.osgi.service.component"/></code></para><para><code><xref
              linkend="org.osgi.service.component.annotations"/></code></para></entry>

              <entry><code><xref endterm="org.osgi.service.component-version"
              linkend="service.component"/></code></entry>
            </row>

            <row>
              <entry><xref linkend="service.event"
              xrefstyle="template:%n %t"/></entry>

              <entry><code><xref
              linkend="org.osgi.service.event"/></code></entry>

              <entry><code><xref endterm="org.osgi.service.event-version"
              linkend="service.event"/></code></entry>
            </row>

            <row>
              <entry><xref linkend="service.dmt"
              xrefstyle="template:%n %t"/></entry>

              <entry><para><code><xref
              linkend="org.osgi.service.dmt"/></code></para><para><code><xref
              linkend="org.osgi.service.dmt.notification"/></code></para><para><code><xref
              linkend="org.osgi.service.dmt.notification.spi"/></code></para><para><code><xref
              linkend="org.osgi.service.dmt.security"/></code></para><para><code><xref
              linkend="org.osgi.service.dmt.spi"/></code></para></entry>

              <entry><code><xref endterm="org.osgi.service.dmt-version"
              linkend="service.dmt"/></code></entry>
            </row>

            <row>
              <entry><xref linkend="service.tr069todmt"
              xrefstyle="template:%n %t"/></entry>

              <entry><code><xref
              linkend="org.osgi.service.tr069todmt"/></code></entry>

              <entry><code><xref endterm="org.osgi.service.tr069todmt-version"
              linkend="service.tr069todmt"/></code></entry>
            </row>

            <row>
              <entry><xref linkend="util.xml"
              xrefstyle="template:%n %t"/></entry>

              <entry><code><xref linkend="org.osgi.util.xml"/></code></entry>

              <entry><code><xref endterm="org.osgi.util.xml-version"
              linkend="util.xml"/></code></entry>
            </row>
          </tbody>
        </tgroup>
      </table>

      <para><superscript>*</superscript> – This is not a Java package but
      contains DMT Types.</para>

      <para>When a component is represented in a bundle, a
      <code>version</code> attribute is needed in the declaration of the
      Import-Package or Export-Package manifest headers.</para>
    </section>
  </section>

  <section>
    <title>References</title>

    <bibliolist>
      <bibliomixed xml:id="i310173"><title>Bradner, S., Key words for use in
      RFCs to Indicate Requirement
      Levels</title>http://www.ietf.org/rfc/rfc2119.txt, March
      1997.</bibliomixed>

      <bibliomixed xml:id="i432874"><title><xref linkend="intro.core.release"
      xrefstyle="template:%t"/></title>http://www.osgi.org/Specifications/HomePage</bibliomixed>

      <bibliomixed xml:id="i434636"><title>Home Gateway
      Initiative</title>http://www.homegatewayinitiative.org</bibliomixed>

      <bibliomixed xml:id="i435333"><title>HG Requirements for Software
      Execution
      Environment</title>http://www.homegatewayinitiative.org/publis/RD-008-R3.pdf</bibliomixed>

      <bibliomixed xml:id="i434644"><title>UPnP™
      Forum</title>http://upnp.org</bibliomixed>

      <bibliomixed xml:id="i434640"><title>Broadband
      Forum</title>http://www.broadband-forum.org</bibliomixed>

      <bibliomixed xml:id="i437630"><title>UPnP Device Architecture
      1.0</title>http://www.upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v1.0.pdf</bibliomixed>

      <bibliomixed xml:id="i437933"><title>TR-157 Amendment 3 Component
      Objects for
      CWMP</title>http://www.broadband-forum.org/technical/download/TR-157_Amendment-3.pdf</bibliomixed>
    </bibliolist>
  </section>
</chapter>
