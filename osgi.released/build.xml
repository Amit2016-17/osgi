<project name="released" default="publish">
	
	<dirname property="project" file="${ant.file}" />
	<dirname property="workspace" file="${project}" />
	<basename property="project.name" file="${project}" />
	<property environment="env"/>
	<taskdef resource="net/sf/antcontrib/antcontrib.properties" classpath="${workspace}/cnf/ant-contrib/ant-contrib-0.6.jar"/>

	<property name="projects" value="
		ee.minimum,
		ee.foundation,
		osgi,
		org.osgi.impl.framework,
		osgi.internal,
		osgi.refimpl,
		osgi.test,
		org.osgi.test.tool"/>
	
	<target name="publish">
		<foreach delimiter=" 
			," list="${projects}" target="publish_item" param="item"/>
	</target>
		
	<target name="publish_item">
		<ant dir="${workspace}/${item}" inheritAll="false">
			<property name="release.dir" value="${workspace}" />
		</ant>
	</target>

	<target name="clean">
		<delete failonerror="false">
			<fileset dir="${project}" includes="**/*.bak **/~* *.jar" />
			<fileset dir="${workspace}/cnf/cache" includes="${project.name}" />
		</delete>

		<foreach delimiter=" 
			," list="${projects}" target="clean_item" param="item"/>
	</target>
		
	<target name="clean_item">
		<ant dir="${workspace}/${item}" inheritall="false" target="clean"/>
	</target>
</project>
