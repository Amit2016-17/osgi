<?xml version="1.0" encoding="UTF-8"?>
<project name="project" default="run-core">
	
	<target name="clean">
		<delete dir="configuration"/> <!-- delete bundles dir to clear permdata -->
		<delete dir="cdresources"/> <!-- delete upnp cd resources -->
	</target>	

	<target name="run-core">
		<antcall target="-run">
		  <param name="impls" value="file:../osgi.core.impls.jar"/>
		  <param name="classpath" value=" ../testcond.jar"/>
		</antcall>
	</target>
	
	<target name="run-cmpn">
		<antcall target="-run">
			  <param name="impls" value="file:../osgi.cmpn.impls.jar"/>
			  <param name="classpath" value=""/>
		</antcall>
	</target>
	
	<target name="run-mobile">
		<antcall target="-run">
			  <param name="impls" value="file:../osgi.mobile.impls.jar"/>
			  <param name="classpath" value=""/>
		</antcall>
	</target>
	
	<target name="-run" depends="clean">
		<echo>Testing ${impls}</echo>
		<java fork="true" classname="org.eclipse.osgi.framework.launcher.Launcher">	
			<classpath path="../org.osgi.impl.framework.eclipse.jar"/>
			<classpath path="${classpath}"/>
			<jvmarg value="-Djava.security.manager=org.eclipse.osgi.framework.internal.core.FrameworkSecurityManager"/>
			<jvmarg value="-Djava.security.policy=policy"/>
			<jvmarg value="-Dosgi.install.area=file:"/>
			<jvmarg value="-Dosgi.support.signature.verify=true"/>
			<jvmarg value="-Xverify:none"/>
			<arg value="-console:2202"/>
			<arg value="init"/>
			<arg value="launch"/>
			<arg value="install file:../osgi.jar start"/>
			<arg value="install file:../osgi.target.jar start"/>
			<arg value="install ${impls} start"/>
		</java>
	</target>
</project>
