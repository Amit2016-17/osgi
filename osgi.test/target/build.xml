<?xml version="1.0" encoding="UTF-8"?>
<project name="project" default="run-core">
	
	<target name="clean">
		<delete> <!-- delete bundles dir to clear permdata -->
			<fileset dir="configuration">
				<exclude name="config.ini"/>
			</fileset>
		</delete>
		<delete dir="cdresources"/> <!-- delete upnp cd resources -->
	</target>	

	<target name="run-core">
		<antcall target="-run">
			<param name="impls" value="../generated/osgi.core.impls.jar@start"/>
		</antcall>
	</target>
	
	<target name="run-cmpn">
		<antcall target="-run">
			<param name="impls" value="../generated/osgi.cmpn.impls.jar@start"/>
		</antcall>
	</target>
	
	<target name="run-mobile">
		<antcall target="-run">
			<param name="impls" value="../generated/osgi.mobile.impls.jar@start"/>
		</antcall>
	</target>
	
	<target name="-run" depends="clean">
		<echo>Testing ${impls}</echo>
		<java fork="true" jar="../generated/org.osgi.impl.framework.eclipse.jar">	
			<jvmarg value="-Dosgi.install.area=file:"/>
			<jvmarg value="-Dosgi.bundles=../generated/testcond.jar,osgi.jar@start,../generated/osgi.target.jar@start,${impls}"/>
		</java>
	</target>
</project>
