<?xml version="1.0" encoding="UTF-8"?>
<components xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd">

    <description>
        This creates a ServiceManager instance with a series of components that will be exported
        as services that are managed by the ServiceManager.  This exports a variety of matches, which
        are intended to test sorting and reference collection iteration.
    </description>

    <!-- define a series of components for service export -->
    <component id="ServiceOneA" class="org.osgi.test.cases.blueprint.services.TestGoodServiceSubclass">
        <constructor-arg value="ServiceOneA"/>
        <constructor-arg value="4"/>
    </component>

    <component id="ServiceOneB" class="org.osgi.test.cases.blueprint.services.TestGoodServiceSubclass">
        <constructor-arg value="ServiceOneB"/>
        <constructor-arg value="-1"/>
    </component>

    <component id="ServiceOneC" class="org.osgi.test.cases.blueprint.services.TestGoodServiceSubclass">
        <constructor-arg value="ServiceOneC"/>
        <constructor-arg value="0"/>
    </component>

    <component id="ServiceOneD" class="org.osgi.test.cases.blueprint.services.TestGoodServiceSubclass">
        <constructor-arg value="ServiceOneD"/>
        <constructor-arg value="100"/>
    </component>

    <component id="ServiceOneE" class="org.osgi.test.cases.blueprint.services.TestGoodServiceSubclass">
        <constructor-arg value="ServiceOneE"/>
        <constructor-arg value="42"/>
    </component>

    <!-- The following should be filtered out because they don't implement both requested intefaces -->
    <component id="BadServiceOneA" class="org.osgi.test.cases.blueprint.services.TestGoodServiceSubclass">
        <constructor-arg value="BadServiceOneA"/>
        <constructor-arg value="43"/>
    /*  */
    </component>
    <component id="BadServiceOneB" class="org.osgi.test.cases.blueprint.services.TestGoodServiceSubclass">
        <constructor-arg value="BadServiceOneB"/>
        <constructor-arg value="43"/>
    </component>

    <component id="ServiceManager" class="org.osgi.test.cases.blueprint.services.ServiceManager">
        <constructor-arg ref="bundleContext"/>
        <constructor-arg>
            <list>
                <component class="org.osgi.test.cases.blueprint.services.ManagedService">
                    <property name="bundleContext" ref="bundleContext"/>
                    <property name="name">
                        <idref component="ServiceOneD"/>
                    </property>
                    <property name="service" ref="ServiceOneD"/>
                    <property name="interfaces">
                        <set>
                            <value>org.osgi.test.cases.blueprint.services.TestServiceOne</value>
                            <value>org.osgi.test.cases.blueprint.services.TestServiceTwo</value>
                        </set>
                    </property>
                    <property name="start" value="true"/>
                    <property name="ranking" value="1"/>
                </component>
                <component class="org.osgi.test.cases.blueprint.services.ManagedService">
                    <property name="bundleContext" ref="bundleContext"/>
                    <property name="name">
                        <idref component="ServiceOneB"/>
                    </property>
                    <property name="service" ref="ServiceOneB"/>
                    <property name="interfaces">
                        <set>
                            <value>org.osgi.test.cases.blueprint.services.TestServiceOne</value>
                            <value>org.osgi.test.cases.blueprint.services.TestServiceTwo</value>
                        </set>
                    </property>
                    <property name="start" value="true"/>
                    <property name="ranking" value="3"/>
                </component>
                <component class="org.osgi.test.cases.blueprint.services.ManagedService">
                    <property name="bundleContext" ref="bundleContext"/>
                    <property name="name">
                        <idref component="ServiceOneA"/>
                    </property>
                    <property name="service" ref="ServiceOneA"/>
                    <property name="interfaces">
                        <set>
                            <value>org.osgi.test.cases.blueprint.services.TestServiceOne</value>
                            <value>org.osgi.test.cases.blueprint.services.TestServiceTwo</value>
                        </set>
                    </property>
                    <property name="start" value="true"/>
                    <property name="ranking" value="4"/>
                </component>
                <component class="org.osgi.test.cases.blueprint.services.ManagedService">
                    <property name="bundleContext" ref="bundleContext"/>
                    <property name="name">
                        <idref component="ServiceOneE"/>
                    </property>
                    <property name="service" ref="ServiceOneE"/>
                    <property name="interfaces">
                        <set>
                            <value>org.osgi.test.cases.blueprint.services.TestServiceOne</value>
                            <value>org.osgi.test.cases.blueprint.services.TestServiceTwo</value>
                        </set>
                    </property>
                    <property name="start" value="true"/>
                    <property name="ranking" value="0"/>
                </component>
                <component class="org.osgi.test.cases.blueprint.services.ManagedService">
                    <property name="bundleContext" ref="bundleContext"/>
                    <property name="name">
                        <idref component="ServiceOneC"/>
                    </property>
                    <property name="service" ref="ServiceOneC"/>
                    <property name="interfaces">
                        <set>
                            <value>org.osgi.test.cases.blueprint.services.TestServiceOne</value>
                            <value>org.osgi.test.cases.blueprint.services.TestServiceTwo</value>
                        </set>
                    </property>
                    <property name="start" value="true"/>
                    <property name="ranking" value="2"/>
                </component>
                <component class="org.osgi.test.cases.blueprint.services.ManagedService">
                    <property name="bundleContext" ref="bundleContext"/>
                    <property name="name">
                        <idref component="BadServiceOneA"/>
                    </property>
                    <property name="service" ref="BadServiceOneA"/>
                    <property name="interfaces">
                        <set>
                            <value>org.osgi.test.cases.blueprint.services.TestServiceOne</value>
                        </set>
                    </property>
                    <property name="start" value="true"/>
                    <property name="ranking" value="2"/>
                </component>
                <component class="org.osgi.test.cases.blueprint.services.ManagedService">
                    <property name="bundleContext" ref="bundleContext"/>
                    <property name="name">
                        <idref component="BadServiceOneB"/>
                    </property>
                    <property name="service" ref="BadServiceOneB"/>
                    <property name="interfaces">
                        <set>
                            <value>org.osgi.test.cases.blueprint.services.TestServiceTwo</value>
                        </set>
                    </property>
                    <property name="start" value="true"/>
                    <property name="ranking" value="2"/>
                </component>
            </list>
        </constructor-arg>
    </component>

   <!-- simple the service manager service when finished.  Note that the ServiceManager component
        might register services for this bundle before it is registered itself.  For cross-bundle dependency
        purposes, we're depending on this                                                                     -->
   <service id="ServiceManagerService" ref="ServiceManager" interface="org.osgi.test.cases.blueprint.services.ServiceManager"/>
</components>

